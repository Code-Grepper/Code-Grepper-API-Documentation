var data,userDailyActivity,user_id=getParameterByName("id"),my_user_id=document.getElementById("my_user_id").value;function init(){restore_options(),!user_id&&my_user_id&&(window.location.href="/app/profile.php?id="+my_user_id),user_id==my_user_id&&(document.getElementById("editProfileButton").style.display="block",document.getElementById("profile_container").addEventListener("click",selectFileToUpload),document.getElementById("profile_image_edit_show").style.display="block",document.getElementById("profile_container").style.cursor="pointer",document.getElementById("followButton").style.display="none")}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function get_belt_rank(e){makeRequest("GET",prod_api+"/get_user_stats.php?uid="+user_id).then(function(e){var t=JSON.parse(e);document.getElementById("overall_belt_color").innerHTML=capitalizeFirstLetter(t.coding_belt[0]),document.getElementById("overallbelt").className+=" "+t.coding_belt[0],document.getElementById("belt_system_holder").style.display="block"})}function showHelpedStats(){makeRequest("GET",prod_api+"/profile_helped_stats.php?id="+user_id).then(function(e){var t=JSON.parse(e);document.getElementById("developers_helped_text").textContent=t.developers_helped,document.getElementById("hits_text").textContent=t.hits})}function showTopAnswers(){makeRequest("GET",prod_api+"/profile_top_answers.php?id="+user_id).then(function(e){data=JSON.parse(e);var t="";for(let a=0;a<data.top_answers.length;a++){var i=data.top_answers[a].created_at.split(/[- :]/),n=(e=new Date(Date.UTC(i[0],i[1]-1,i[2],i[3],i[4],i[5])),dateToNiceDayString(e));t+="<li>",t+='<span  title="Quality Score" class="top_answers_quality_score"><i class="icon certificate brand_purple"></i>'+parseFloat(data.top_answers[a].score).toFixed(1)+"</span>",t+='<span  title="Views" class="top_answers_views"><i class="icon eye brand_yellow"></i>'+data.top_answers[a].total_results+"</span>",t+='<span title="Upvotes" class="top_answers_upvotes"><i class="icon thumbs up brand_green"></i>'+data.top_answers[a].upvotes+"</span>",t+='<span   title="Downvotes" style="margin-right:0px;" class="top_answers_downvotes"><i class="icon thumbs down brand_red"></i>'+data.top_answers[a].downvotes+"</span>",t+='<a  onclick="showAnswer(this,'+a+')" class="top_answers_search_term">'+data.top_answers[a].search_term+' <i class="answer_more_icon icon angle right"></i> </a> <div class="top_answer_date lighter smaller">'+n+"</div>",t+='<div style="clear:both"></div></li>'}document.getElementById("top_answers").innerHTML=t})}function restore_options(){showHelpedStats(),showTopAnswers(),makeRequest("GET",prod_api+"/profile.php?id="+user_id).then(function(e){var t=JSON.parse(e);if(t.profile_image&&(document.getElementById("profile_image_edit").src="/profile_images/"+t.profile_image),t.fun_name){document.getElementById("page_title").textContent=t.fun_name+"'s Profile",document.getElementById("fun_name_input").value=t.fun_name;for(var i=document.getElementsByClassName("username_text"),n=0;n<i.length;n++)i[n].textContent=t.fun_name}t.real_name&&(document.getElementById("real_name_holder").style.display="block",document.getElementById("real_name_text").textContent=t.real_name,document.getElementById("real_name_input").value=t.real_name),t.twitter_name&&(document.getElementById("twitter_name_text").textContent="@"+t.twitter_name,document.getElementById("twitter_name_text").href="https://twitter.com/"+t.twitter_name,document.getElementById("twitter_name_text_holder").style.display="block",document.getElementById("twitter_name_input").value=t.twitter_name),t.location&&(document.getElementById("location_text").textContent=t.location,document.getElementById("location_text_holder").style.display="block",document.getElementById("location_input").value=t.location),t.donate_link&&(document.getElementById("help_with_donate").style.display="block",document.getElementById("help_with_no_donate").style.display="none",document.getElementById("donate_link_text_holder").style.display="block",document.getElementById("donate_link_text").href=t.donate_link,document.getElementById("donate_link_input").value=t.donate_link),t.how_to_help&&(document.getElementById("how_to_help_text").textContent=t.how_to_help,document.getElementById("how_to_help_input").value=t.how_to_help),document.getElementById("coding_activity_box")&&(t.enable_coding_activity&&(document.getElementById("coding_activity_is_enabled_holder").style.display="block"),user_id!=my_user_id&&1==t.is_activity_private||(document.getElementById("coding_activity_box").style.display="block",document.getElementById("coding_activity_box_br").style.display="block"),user_id!=my_user_id&&1==t.is_daily_activity_private||(document.getElementById("user_historical_coding_activity_holder").style.display="block")),user_id==my_user_id&&(showRankPrivacy(t.is_rank_private),showActivityEnabled(t.enable_coding_activity),showActivityPrivacy(t.is_activity_private),showExpertisePrivacy(t.is_expertise_private),showDailyActivityPrivacy(t.is_daily_activity_private))})}function showAnswer2(e,t){var i=e.parentElement.getElementsByTagName("textarea"),n=e.parentElement.getElementsByClassName("answer_more_icon");if(i.length){n[0].classList.add("right"),n[0].classList.remove("down"),e.parentElement.removeChild(i[0]);var a=e.parentElement.lastChild;e.parentElement.removeChild(a)}else{n[0].classList.add("down"),n[0].classList.remove("right");var r=document.createElement("textArea");r.textContent=userDailyActivity[t].answer,e.parentElement.appendChild(r),TaysCodeMirror.fromTextArea(r,{lineNumbers:!0,theme:"prism-okaidia",mode:"javascript",viewportMargin:1/0})}}function showAnswer(e,t){var i=e.parentElement.getElementsByTagName("textarea"),n=e.parentNode.getElementsByClassName("answer_more_icon");if(i.length){n[0].classList.add("right"),n[0].classList.remove("down"),e.parentNode.removeChild(i[0]);var a=e.parentElement.lastChild;e.parentNode.removeChild(a)}else{n[0].classList.add("down"),n[0].classList.remove("right");var r=document.createElement("textArea");r.textContent=data.top_answers[t].answer,e.parentElement.appendChild(r),TaysCodeMirror.fromTextArea(r,{lineNumbers:!0,theme:"prism-okaidia",mode:"javascript",viewportMargin:1/0})}}function selectFileToUpload(){document.getElementById("profile_image_input").click()}function showCodingActivityHelpVideo(){document.getElementById("code_activity_help_video").style.display="block"}function editProfile(){document.getElementById("edit_profile_popup").style.display="block"}function startsWith(e,t){return 0===e.lastIndexOf(t,0)}function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function showDailyActivityPrivacy(e){if(e){t="<i class='icon hand point left outline'></i>daily activity is private: <a href='#' id='grepperSetDailyActivityRankPrivateNo'>set public </a>";document.getElementById("daily_activity_privacy").innerHTML=t,document.getElementById("grepperSetDailyActivityRankPrivateNo").addEventListener("click",function(e){grepperSetDailyActivityRankPrivate(0)})}else{var t="<i class='icon hand point left outline'></i>daily activity is public: <a href='#' id='grepperSetDailyActivityRankPrivateYes'>set private </a>";document.getElementById("daily_activity_privacy").innerHTML=t,document.getElementById("grepperSetDailyActivityRankPrivateYes").addEventListener("click",function(e){grepperSetDailyActivityRankPrivate(1)})}}function showActivityEnabled(e){if(e){t="<i class='icon hand point left outline'></i>coding activity is enabled: <a href='#' id='grepperSetActivityDisabled'>disable coding activity</a>";document.getElementById("activity_enabled_holder").innerHTML=t,document.getElementById("coding_activity_is_enabled_holder").style.display="block",document.getElementById("grepperSetActivityDisabled").addEventListener("click",function(e){grepperSetActivityEnabled(0)})}else{var t="<i class='icon hand point left outline'></i>coding activity is disabled: <a href='#' id='grepperSetActivityEnabled'>enable coding activity</a>";document.getElementById("activity_enabled_holder").innerHTML=t,document.getElementById("coding_activity_is_enabled_holder").style.display="none",document.getElementById("grepperSetActivityEnabled").addEventListener("click",function(e){grepperSetActivityEnabled(1)})}}function showExpertisePrivacy(e){if(document.getElementById("activity_expertise_privacy"))if(e){t="<i class='icon hand point left outline'></i>coding expertise is private: <a href='#' id='grepperSetExpertiseRankPrivateNo'>set public </a>";document.getElementById("activity_expertise_privacy").innerHTML=t,document.getElementById("is_expertise_private_holder").style.display="none",document.getElementById("grepperSetExpertiseRankPrivateNo").addEventListener("click",function(e){grepperSetExpertiseRankPrivate(0)})}else{var t="<i class='icon hand point left outline'></i>coding expertise is public: <a href='#' id='grepperSetExpertiseRankPrivateYes'>set private </a>";document.getElementById("activity_expertise_privacy").innerHTML=t,document.getElementById("is_expertise_private_holder").style.display="block",document.getElementById("grepperSetExpertiseRankPrivateYes").addEventListener("click",function(e){grepperSetExpertiseRankPrivate(1)})}}function showActivityPrivacy(e){if(e){t="<i class='icon hand point left outline'></i>activity overview is private: <a href='#' id='grepperSetActivityRankPrivateNo'>set public </a>";document.getElementById("activity_privacy").innerHTML=t,document.getElementById("grepperSetActivityRankPrivateNo").addEventListener("click",function(e){grepperSetActivityRankPrivate(0)})}else{var t="<i class='icon hand point left outline'></i>activity overview is public: <a href='#' id='grepperSetActivityRankPrivateYes'>set private </a>";document.getElementById("activity_privacy").innerHTML=t,document.getElementById("grepperSetActivityRankPrivateYes").addEventListener("click",function(e){grepperSetActivityRankPrivate(1)})}}function showRankPrivacy(e){if(e){t="<i class='icon hand pointer outline'></i>belt is private: <a href='#' id='grepperSetRankPrivateNo'>set public </a>";document.getElementById("rank_privacy").innerHTML=t,document.getElementById("grepperSetRankPrivateNo").addEventListener("click",function(e){grepperSetRankPrivate(0)})}else{var t="<i class='icon hand pointer outline'></i>belt is public: <a href='#' id='grepperSetRankPrivateYes'>set private </a>";document.getElementById("rank_privacy").innerHTML=t,document.getElementById("grepperSetRankPrivateYes").addEventListener("click",function(e){grepperSetRankPrivate(1)})}}function getPixels(e){for(var t=["abap","actionscript","assembly","basic","c","clojure","cobol","cpp","csharp","css","dart","delphi","elixir","erlang","fortran","fsharp","go","groovy","haskell","html","java","javascript","julia","kotlin","language","lisp","lua","matlab","objectivec","pascal","perl","php","postscript","prolog","python","r","ruby","rust","scala","scheme","shell","smalltalk","sql","swift","term","typescript","vb","webassembly","whatever"],i=[],n=0,a=0;a<t.length;a++)parseInt(e[t[a]])>0&&(i.push([t[a],parseInt(e[t[a]])]),n+=parseInt(e[t[a]]));if(i.sort(function(e,t){return t[1]-e[1]}),!i)return"";var r="";for(i.length,a=0;a<i.length;a++)n>12?i[a].push(Math.floor(i[a][1]/n*144)):i[a].push(12*i[a][1]);for(a=0;a<i.length;a++)for(var o=0;o<i[a][2];o++)r+="<div class='l_pixel pixel_lang_"+i[a][0]+"'></div>";return r}function getUserActivityStats(e){makeRequest("GET","/api/get_user_activity_stats.php?user_id="+user_id).then(function(e){for(var t=document.getElementById("user_historical_coding_activity"),i=document.getElementById("user_historical_coding_activity_top_languages"),n=document.getElementById("user_historical_coding_activity_top_frameworks"),a=JSON.parse(e),r="",o=0;o<a.a.length;o++){o%7==0&&(0!=o&&(r+="</div>"),r+="<div class='activity_week_box'>");var l=a.a[o].ymd.split(/[- :]/),s=(e=new Date(l[0],l[1]-1,l[2]),dateToNiceDayStringDay(e));r+="<div onclick=\"getUserDailyCodingActivity('"+a.a[o].ymd+"')\" data-tooltip='"+s+"'  data-position='top center' title='"+s+"' class='activity_day_box'>"+getPixels(a.a[o])+"</div>"}t.innerHTML=r;var d="";for(o=0;o<a.s.length&&!(o>9)&&!(a.s[o][1]<1);o++)d+="<div class='user_top_language_holder'><div class='activity_day_box pixel_lang_"+a.s[o][0]+"'></div> "+a.s[o][0]+"</div>";i.innerHTML=d;var c="",p=a.f;for(o=0;o<p.length&&!(o>9);o++)c+="<div class='user_top_frameworks_holder'> <img class='framework_icon_small' src='/images/framework_icons/"+p[o][2]+".png'> <span>"+p[o][0]+"</span></div>";n.innerHTML=c})}function displayUserDailyActivity(e,t){userDailyActivity=e;var i="";document.getElementById("user_coding_activity_header_date").innerHTML=dateToNiceDayStringDay(t);for(var n=0;n<e.length;n++){var a=e[n].created_at.split(/[- :]/),r=new Date(Date.UTC(a[0],a[1]-1,a[2],a[3],a[4],a[5])),o=(dateToNiceDayStringDay(r),dateToNiceDayStringTimeOnly(r)),l="Viewed ";e[n].upvote?l="Upvoted ":e[n].is_my_answer&&(l="Answered "),i+="<div class='user_coding_activity'>",i+="<div class='user_coding_activity_text' onclick='showAnswer2(this,"+n+")'>",i+=l+"<a href='profile.php?id="+e[n].answer_user_id+"'>"+e[n].answer_fun_name+"'s</a> code answer to â€œ"+e[n].answer_title+"â€<i class='answer_more_icon icon angle right'></i>",i+="</div>",i+="<div class='user_coding_activity_time'>"+o+"</div>",i+="<div style='clear:both'></div>",i+="</div>"}document.getElementById("user_historical_coding_activity_day").innerHTML=i}function getUserDailyCodingActivity(e){if(void 0!==e)var t=e.split(/[- :]/),i=new Date(t[0],t[1]-1,t[2]);else i=new Date;var n=("0"+i.getDate()).slice(-2),a=("0"+(i.getMonth()+1)).slice(-2),r=i.getFullYear();makeRequest("GET","/api/get_user_daily_coding_activity.php?day="+(r+"-"+a+"-"+n)+"&user_id="+user_id).then(function(e){displayUserDailyActivity(JSON.parse(e).a,i)})}function follow(e,t){var i=1==e.getAttribute("is_following")?0:1;makeRequest("GET",prod_api+"/follow.php?follow_user_id="+t+"&follow="+i).then(function(t){i?(e.setAttribute("is_following",1),e.textContent="Unfollow"):(e.setAttribute("is_following",0),e.textContent="Follow")})}function grepperSetDailyActivityRankPrivate(e){makeRequest("GET",prod_api+"/update_rank_privacy.php?is_daily_activity_private="+e).then(function(t){showDailyActivityPrivacy(e)})}function grepperSetActivityEnabled(e){makeRequest("GET","/api/update_rank_privacy.php?enable_coding_activity="+e).then(function(t){showActivityEnabled(e)})}function grepperSetActivityRankPrivate(e){makeRequest("GET",prod_api+"/update_rank_privacy.php?is_activity_private="+e).then(function(t){showActivityPrivacy(e)})}function grepperSetExpertiseRankPrivate(e){makeRequest("GET",prod_api+"/update_rank_privacy.php?is_expertise_private="+e).then(function(t){showExpertisePrivacy(e)})}function grepperSetRankPrivate(e){makeRequest("GET",prod_api+"/update_rank_privacy.php?is_rank_private="+e).then(function(t){showRankPrivacy(e)})}document.addEventListener("DOMContentLoaded",init),document.getElementById("profile_image_input").addEventListener("change",function(){if(this.files&&this.files[0]){if(-1===["image/jpg","image/jpeg","image/png","image/gif"].indexOf(this.files[0].type))return void alert("Oops! Try uploading a png, jpg or gif image instead.");if(this.files[0].size>1e7)return void alert("Yikes! That file is a little too big, try something under 10MB");document.getElementById("profile_image_edit").src=URL.createObjectURL(this.files[0]);var e=new FormData;e.append("file",this.files[0]),e.append("update","profile_image"),makeRequest("POST",prod_api+"/profile.php",e).then(function(e){},function(e){413==e.status&&alert("Oops, That image file is too large. Max size is 8mb")})}}),document.getElementById("save_profile").addEventListener("click",function(){var e=document.getElementById("donate_link_input").value;startsWith(e,"paypal.me")?e="https://"+e:!startsWith(e,"https:")&&validateEmail(e)&&(e="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business="+e+"&currency_code=USD&source=url");var t=new FormData;t.append("update","profile_basic"),t.append("fun_name",document.getElementById("fun_name_input").value),t.append("real_name",document.getElementById("real_name_input").value),t.append("twitter_name",document.getElementById("twitter_name_input").value),t.append("location",document.getElementById("location_input").value),t.append("donate_link",e),t.append("how_to_help",document.getElementById("how_to_help_input").value),makeRequest("POST",prod_api+"/profile.php",t).then(function(){location.reload()})}),document.getElementById("coding_activity_box")&&(getUserActivityStats(),getUserDailyCodingActivity());